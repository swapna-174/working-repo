Optimize Query Logic:

Use CTEs (Common Table Expressions) or temporary tables for complex subqueries to simplify and potentially reuse results.
Avoid unnecessary joins and instead use semi-joins or exists where possible.
Use window functions judiciously; they are powerful but can be costly in terms of performance.
