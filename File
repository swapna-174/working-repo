 SELECT
 *
 FROM
  (

	SELECT
	* 
	FROM 
	
       (
       SELECT
		res.PAT_ID 
		,cc.COMPONENT_ID
		,cc.NAME
	   ,res.ORD_VALUE
--		,res.RESULT_DATE
		,res.RESULT_TIME
	    ,rank() over ( partition by res.PAT_ID order by res.PAT_ID,res.RESULT_TIME desc,RowNum) rank

		 FROM CLARITY_COMPONENT cc
		 INNER JOIN ORDER_RESULTS res ON res.COMPONENT_ID = cc.COMPONENT_ID
		WHERE cc.NAME LIKE '%A1C%'
--		AND res.PAT_ID = 'Z1610573'
		  
	  )
		
   	where rank <= 3
   	ORDER BY rank, PAT_ID
	   	
